<!DOCTYPE html>
<html>

  <header>
    <title>
      Datathon Project Submit
    </title>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js">
    </script>
    <link href="./datathon.css" rel="stylesheet">
  </header>


  <body>

    <head>
      <img class="head-image" src="theme/header/IoTCreator.png">
      <h1>Datathon Submit Step 2</h1>
      <hr>
    </head>

    <main>
      <h2>1. Project's Information</h2>
      <form method="post" enctype="multipart/form-data" onsubmit="return check();" action"_top">
        <!-- <form method="post" enctype="multipart/form-data" onsubmit="return check();" action="./submit_complete"> -->
        <label for="title">Title</label>
        <input size="80" pattern="\s*(\S\s*){3,}" id="title" name="title" placeholder="Project title, max 80 characters" required>
        <br>

        <label for="description">Description</label>
        <textarea rows="10" cols="78" id="description" name="description" placeholder="Describe project in detail" required></textarea>
        <br>

        <label for="category">Category</label>
        <select id="category" name="category" required>
          <option value="none" selected disabled hidden> Select a Category</option>
          <option value="Home Automation - Indoor">Home Automation - Indoor</option>
          <option value="Home Automation - Outdoor">Home Automation - Outdoor</option>
          <option value="Home Lighting">Home Lighting</option>
          <option value="Home Security">Home Security</option>
          <option value="Smart Appliances & Furniture">Smart Appliances & Furniture</option>
          <option value="Chore Management">Chore Management</option>
          <option value="Entertainment & Games">Entertainment & Games</option>
          <option value="Health, Wellness, Fitness & Nutrition">Health, Wellness, Fitness & Nutrition</option>
          <option value="School & Education">School & Education</option>
        </select>
        <br>

        <label for="keywords">Keywords</label>
        <input size="80" pattern="\s*(\S\s*){4,}" class="form-control" id="keywords" name="keywords" placeholder="Enter comma separated keywords" required>
        <br>

        <label for="links">Hardware Links</label>
        <textarea rows="5" cols="78" id="links" name="links" placeholder="Paste links to hardware description (e.g. where to buy) used in the project." required></textarea>
        <br>

        <br>
        <hr>

        <h2>2. Project's Implementation</h2>
        <p>
          To extract the project's implementation
        </p>
        <ol>
          <li>login to your IoT-Creator account</li>
          <li>select "Export" from the menu in the top-right page corner</li>
          <li>click the "Copy to clipboard" button</li>
          <li>paste to the input area below (or to text file first)</li>
        </ol>
        <p>
          Remember: to facilitate reviews, every project must include flows to insert
          IoT sensor data and to model IoT actuator actions.
        </p>
        <label for="cloud_code">Iot-Creator Code</label>
        <br>
        <textarea id="cloud_code" name="cloud_code" rows="15" cols="100" placeholder="Paste exported IoT-Creator flow in JSON format" required></textarea>
        <br>

        <p>
          An image and/or video can help users understand how your project works,
          and improve your odds of placing in the competition. Below, you have
          an opportunity to load an image file and/or video file.
          This is optional.
        </p>
        <label for="image_file" style="width:200px;">
          Image <small>(less than 1 MB)</small>
        </label>
        <input type="file" accept="image/*" id="image_file" name="image_file" required>
        <script>
          // $(document).ready(function() {
          // $('#image_file').ready(function() {
          //   $('input[type="file"]').change(function() {
          //     var imgpath = document.getElementById('image_file');
          //     if (!imgpath.value == "") {
          //       var img = imgpath.files[0].size;
          //       var imgsize = img / (1024 * 1024);
          //       if (file && file['type'].split('/')[0] === 'image') {
          //         if (imgsize > 5) {
          //           alert("Image size should be less than 5 MB");
          //           imgpath.value = "";
          //         }
          //       } else
          //         imgpath.value = "";
          //     } else {
          //       $('#video_file').attr('required', false);
          //     }
          //   });
          // });
        </script>
        <br><br>

        <label for="video_file" style="width:200px;">
          Video <small>(less than 4 MB)</small>
        </label>
        <input type="file" accept=".mp4,video/*" id="video_file" name="video_file" required>

        <script>
          $('#image_file').ready(function() {
            $('input[type="file"]').change(function() {
              var imgpath = document.getElementById('image_file');
              if (!imgpath.value == "") {
                var img = imgpath.files[0].size;
                var imgsize = img / (1024 * 1024);
                var file = imgpath.files[0];
                if (file && file['type'].split('/')[0] === 'image') {
                  if (imgsize > 1) {
                    alert("Image size should be less than 1 MB");
                    imgpath.value = "";
                  } else {
                    // image file successfully added, so video no longer reuqired
                    var vid_element = document.getElementById('video_file')
                    vid_element.removeAttribute("required")
                  }
                } else {
                  imgpath.value = "";
                }
              }
            });
          });

          // $(document).ready(function() {
          $('#video_file').ready(function() {
            $('input[type="file"]').change(function() {
              var vidpath = document.getElementById('video_file');
              if (!vidpath.value == "") {
                var vid = vidpath.files[0].size;
                var vidsize = vid / (1024 * 1024);
                var file = vidpath.files[0];
                if (file && file['type'].split('/')[0] === 'video') {
                  if (vidsize > 4) {
                    alert("Video file size should be less than 4 MB");
                    vidpath.value = "";
                  } else {
                    // video file successfully added, so image no longer reuqired
                    var img_element = document.getElementById('image_file')
                    img_element.removeAttribute("required")
                  }
                } else {
                  vidpath.value = "";
                }
              }
            });
          });
        </script>
        <br><br>

        <hr>

        <h2>3. Finalize Submission</h2>
        <label class="longlabel" for="submit">
          Click button below to submit project. Once submitted, the project cannot be modified.
        </label>
        <br>
        <button type="submit" id="submit" name="submit">Submit</button>
        <br><br>
      </form>

      <script type="text/javascript">
        function check() {
          alert("This project has been submitted.");
          window.location.reload();
        }
      </script>

    </main>
  </body>

</html>